const gui={MAX_UID:1e6,init:function(t){this.context=t||"body";this.initTheme();$('[data-gui-behavior="theme-switcher"]',this.context).GUIThemeSwitcher();$('[data-gui-behavior="tabs"]',this.context).GUITabs();$('[data-gui-behavior="copy"]',this.context).GUICopy();$('[data-gui-behavior="range"]',this.context).GUIControlRange();$('[data-gui-behavior="modal"]',this.context).GUIModal();$('[data-gui-behavior="fullscreen"]',this.context).GUIFullscreen();$('[data-gui-behavior="card-loading"]',this.context).on("click",(function(){$(this).closest(".card").addClass("loading")}));$('#gui_modal [data-bs-dismiss="modal"]').on("click",(function(t){t.preventDefault();$(this).closest(".modal").data("gui.modal").hide()}));$("[data-loading-text]",this.context).on("click",(function(){$(this).GUIButton("loading")}));$('[data-bs-toggle="tooltip"]',this.context).each((function(){new bootstrap.Tooltip($(this)[0],{})}));$('[data-bs-toggle="popover"]',this.context).each((function(){new bootstrap.Popover($(this)[0],{})}));$("select[readonly]").on("focus",(function(){$(this).trigger("blur")}));if($(this.context).is(".modal-content")){$(this.context).parents(".modal-dialog").removeClass("loading")}},isDarkMode:function(){return $("html").attr("data-theme")==="dark"},initTheme:function(){if($("html").attr("data-theme")){return}if(Cookies.get("dark-mode")!==undefined){if(Cookies.get("dark-mode")==="true"){$("html").attr("data-theme","dark")}}},openModal:function(t,e){let a={};a["data-modal-target"]=t.substring(0,1)==="#"?t:"#gui_modal";a["data-modal-class"]=e||"";if(t.substring(0,1)!=="#"){a["data-modal-url"]=t}$("<a />").attr(a).GUIModal().trigger("click")},openPopup:function(t,e,a,i,n){n=n||"toolbar=no,resizable=yes,scrollbars=yes,menubar=no,location=no,directories=no,status=no";let o=window.screenLeft!=undefined?window.screenLeft:screen.left;let l=window.screenTop!=undefined?window.screenTop:screen.top;let d=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;let r=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;let s=d/2-a/2+o;let c=r/2-i/2+l;let h=window.open(t,e,n+",width="+a+",height="+i+",top="+c+",left="+s);if(window.focus){h.focus()}},getUID:function(t=""){do{t+=Math.floor(Math.random()*this.MAX_UID)}while(document.getElementById(t));return t},getCssVariable:function(t,e){e=e||$(document.documentElement);return getComputedStyle(e[0]).getPropertyValue(t)},datagridSearch:function(t,e,a){let i=$("#datagrid_search_"+t+" :input").serialize();if(a){i=encodeURI($.map($("#datagrid_search_"+t+" :input").serializeArray(),(function(t){return t.name+"="})).join("&"))}else{$("#datagrid_search_"+t+" [data-search]").GUIButton("loading")}$.ajax({type:"POST",url:e,dataType:"html",data:i,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){$("#"+t).html(e)}})},datagridSearchKeydown:function(t,e,a){if(a.keyCode==13){this.datagridSearch(t,e)}},datagridSelection:function(t,e,a,i,n,o,l,d){let r=$(t);let s="";let c=0;let h="";r.trigger("blur");$(".gui-selector-checkbox input","#"+e).each((function(){if($(this).prop("checked")){s+=$(this).val()+",";c++}}));if(c<1){alert(n["no_elements"])}else if(a&&c>1){alert(n["only_one"])}else{if(o){if(!confirm(o)){return false}}if(r.attr("href").slice(-1)!=="="){h="/"}let t=r.attr("href")+h+s.substring(0,s.length-1);if(i){$.ajax({url:t,context:document.body,type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){$("#"+e).html(t)}})}else if(l){window.open(t)}else if(d){gui.openModal(t,r.attr("data-modal-class"))}else{if(window.location.href){window.location.href=t}else{window.location.replace(t)}}}return false},ignitionErrorFrame:function(t,e){if(e.hasClass("modal-content")){let t=$('<div class="modal-body" />');let a=$('<div class="modal-header" />').append($('<h2 class="modal-title" />').html("Error")).append('<button type="button" class="btn-close" data-bs-dismiss="modal"></button>');e.html("");e.parent().removeClass(["modal-sm","modal-md","modal-lg","modal-xl","modal-xxl"]).addClass("modal-xl");e.append(a);e.append(t);e=t}let a=$("<iframe />");a.css({width:"100%",height:"70vh"});a.get(0).srcdoc=t;e.html(a)},canvasScale:function(t,e){if(!(e<1)||!(e>0))throw"scale must be a positive number <1 ";let a=e*e;let i=t.width;let n=t.height;let o=Math.ceil(i*e);let l=Math.ceil(n*e);let d=0,r=0;let s=0,c=0,h=0,u=0;let m=0,f=0;let g=0,p=0,$=0,w=0,b=0,x=0;let y=false;let v=false;let I=t.getContext("2d").getImageData(0,0,i,n).data;let k=new Float32Array(4*i*n);let C=0,M=0,U=0;let T=0;for(let t=0;t<n;t++){c=t*e;f=0|c;h=4*f*o;v=f!=(0|c+e);if(v){b=f+1-c;x=c+e-f-1}for(d=0;d<i;d++,r+=4){s=d*e;m=0|s;u=h+m*4;y=m!=(0|s+e);if(y){$=m+1-s;w=s+e-m-1}C=I[r];M=I[r+1];U=I[r+2];T=I[r+3];if(!y&&!v){k[u]+=C*a;k[u+1]+=M*a;k[u+2]+=U*a;k[u+3]+=T*a}else if(y&&!v){g=$*e;k[u]+=C*g;k[u+1]+=M*g;k[u+2]+=U*g;k[u+3]+=T*g;p=w*e;k[u+4]+=C*p;k[u+5]+=M*p;k[u+6]+=U*p;k[u+7]+=T*p}else if(v&&!y){g=b*e;k[u]+=C*g;k[u+1]+=M*g;k[u+2]+=U*g;k[u+3]+=T*g;p=x*e;k[u+4*o]+=C*p;k[u+4*o+1]+=M*p;k[u+4*o+2]+=U*p;k[u+4*o+3]+=T*p}else{g=$*b;k[u]+=C*g;k[u+1]+=M*g;k[u+2]+=U*g;k[u+3]+=T*g;p=w*b;k[u+4]+=C*p;k[u+5]+=M*p;k[u+6]+=U*p;k[u+7]+=T*p;p=$*x;k[u+4*o]+=C*p;k[u+4*o+1]+=M*p;k[u+4*o+2]+=U*p;k[u+4*o+3]+=T*p;p=w*x;k[u+4*o+4]+=C*p;k[u+4*o+5]+=M*p;k[u+4*o+6]+=U*p;k[u+4*o+7]+=T*p}}}let _=document.createElement("canvas");_.width=o;_.height=l;let E=_.getContext("2d");let S=E.getImageData(0,0,o,l);let G=S.data;let D=0;for(r=0,u=0;D<o*l;r+=4,u+=4,D++){G[u]=Math.ceil(k[r]);G[u+1]=Math.ceil(k[r+1]);G[u+2]=Math.ceil(k[r+2]);G[u+3]=Math.ceil(k[r+3])}E.putImageData(S,0,0);return _}};gui.init();