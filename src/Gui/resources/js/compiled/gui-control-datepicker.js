!function(t){"use strict";let i=function(e,s){let n=this;this.$element=t(e);this.options=t.extend({},i.DEFAULTS,s);this.DateTime=luxon.DateTime;try{luxon.Info.weekdays("short",{locale:this.options.language})}catch(t){console.error(t.message+": "+this.options.language);return}this.now=this.DateTime.now().setLocale(this.options.language);this.timestamp=this.DateTime.now().setLocale(this.options.language);this.selectedTimestamp=this.timestamp;this.$template=t(this.options.template);this.$prev=t(".dp-prev",this.$template);this.$next=t(".dp-next",this.$template);this.$title=t(".dp-title",this.$template);this.$btnToday=t(".dp-today",this.$template).html(this.options.strings.today);this.$btnClear=t(".dp-clear",this.$template).html(this.options.strings.clear);this.$content=t(".dp-content",this.$template);if(this.options.timeOnly){t(".dp-heading",this.$template).hide();this.$element.addClass("text-center");this.$btnToday.html(this.options.strings.now)}this.options.trigger=this.options.trigger==="self"?this.$element:this.options.trigger;this.options.min=this.options.min!==null?this.DateTime.fromISO(this.options.min):null;this.options.max=this.options.max!==null?this.DateTime.fromISO(this.options.max):null;if(this.options.inline){t(".dp-menu",this.$template).addClass("inline")}else{if(this.options.trigger instanceof jQuery){if(this.options.trigger.is("input")){this.options.trigger.on("focus click",(function(){n.show()}))}else{this.options.trigger.on("click",(function(){n.show()}))}}}this.$btnToday.on("click",(function(){n.setDate(n.now)}));this.$btnClear.on("click",(function(){n.clear()}));this.appendToContent();if(this.options.inline){this.show()}};i.prototype.show=function(){let i=this;if(this.$element.is("input")&&this.$element.val()){let t=this.DateTime.fromFormat(this.$element.val(),this.parsingFormat(),{locale:this.options.language});if(t.isValid){this.timestamp=this.selectedTimestamp=t}}if(this.options.timeOnly){this.displayHours()}else{this.displayDays()}if(!this.options.inline){this.updatePosition();t(window).on("resize.gui.datepicker scroll.gui.datepicker",(function(){i.updatePosition()}));t(document).on("mousedown.gui.datepicker touchend.gui.datepicker",(function(e){if(!t(e.target).closest(".dp-menu").length&&t(".dp-menu").is(":visible")){i.hide()}}))}t(".dp-menu",this.$template).css("display","inline-flex")};i.prototype.hide=function(){if(!this.options.inline){t(".dp-menu",this.$template).hide();t(document).off("mousedown.gui.datepicker touchend.gui.datepicker");t(window).off("resize.gui.datepicker scroll.gui.datepicker")}};i.prototype.displayDays=function(){let i=this;let e=t('<div class="weekdays" />');let s=t('<div class="days" />');this.setTitle(this.timestamp.toFormat("MMMM yyyy"));this.$content.empty();this.$prev.off("click").on("click",(function(){i.timestamp=i.timestamp.startOf("month").minus({month:1});i.displayDays()}));this.$next.off("click").on("click",(function(){i.timestamp=i.timestamp.startOf("month").plus({month:1});i.displayDays()}));this.$title.off("click").on("click",(function(){i.displayMonths()}));t.each(luxon.Info.weekdays("short",{locale:this.options.language}),(function(t,s){e.append('<div class="weekday">'+i.ucFirst(s).substring(0,2)+"</div>")}));this.$content.append(e);let n=this.timestamp;let o=n.minus({month:1}).endOf("month").weekday;if(o<7){n=n.minus({month:1}).endOf("month").minus({days:o-1})}else{n=n.minus({month:1}).endOf("month").minus({days:6})}for(let e=0;e<42;e++){let e=new Array;e.push("day");if(n.month<this.timestamp.month){e.push("prev")}else if(n.month>this.timestamp.month){e.push("next")}if(!this.inRange(n,"yyyy-LL-dd")||this.isDisabledDate(n)){e.push("disabled")}else{if(n.toFormat("yyyy-LL-dd")===this.selectedTimestamp.toFormat("yyyy-LL-dd")){e.push("active")}}if(this.options.displayToday&&n.toFormat("yyyy-LL-dd")===this.now.toFormat("yyyy-LL-dd")){e.push("today")}let o=t("<a />").addClass(e).data("gui.days.date",n).html(n.toFormat("d")).on("click",(function(){if(i.options.withTime){i.timestamp=t(this).data("gui.days.date");i.displayHours()}else{i.setDate(t(this).data("gui.days.date"))}}));s.append(o);n=n.plus({days:1})}this.$content.append(s)};i.prototype.displayMonths=function(){let i=this;let e=t('<div class="months" />');let s=luxon.Info.months("short",{locale:this.options.language});this.setTitle(this.timestamp.toFormat("yyyy"));this.$content.empty();this.$prev.off("click").on("click",(function(){i.timestamp=i.timestamp.minus({year:1});i.displayMonths()}));this.$next.off("click").on("click",(function(){i.timestamp=i.timestamp.plus({year:1});i.displayMonths()}));this.$title.off("click").on("click",(function(){i.displayYears()}));for(let n=0;n<s.length;n++){let o=new Array;o.push("month");if(!this.inRange(this.timestamp.set({month:n+1}),"yyyy-LL")){o.push("disabled")}else{if(n+1===this.selectedTimestamp.month){o.push("active")}}let a=t("<a />").addClass(o).html(i.ucFirst(s[n])).on("click",(function(){i.timestamp=i.timestamp.set({month:n+1});i.displayDays()}));e.append(a)}this.$content.append(e)};i.prototype.displayYears=function(){let i=this;let e=parseInt(this.timestamp.year/10,10)*10;let s=this.DateTime.fromFormat(e+"-01-01","yyyy-LL-dd");let n=t('<div class="years" />');this.setTitle(s.toFormat("yyyy")+"-"+s.plus({year:9}).toFormat("yyyy"),true);this.$content.empty();this.$prev.off("click").on("click",(function(){i.timestamp=s.minus({year:10});i.displayYears()}));this.$next.off("click").on("click",(function(){i.timestamp=s.plus({year:10});i.displayYears()}));for(let s=e;s<e+10;s++){let e=new Array;e.push("year");if(!this.inRange(this.timestamp.set({year:s}),"yyyy")){e.push("disabled")}else{if(s===this.selectedTimestamp.year){e.push("active")}}let o=t("<a />").addClass(e).html(s).on("click",(function(){i.timestamp=i.timestamp.set({year:s});i.displayMonths()}));n.append(o)}this.$content.append(n)};i.prototype.displayHours=function(){let i=this;let e=t('<div class="hours" />');this.setTitle(this.timestamp.toFormat("d LLLL yyyy"),this.options.timeOnly);this.$content.empty();if(!this.options.timeOnly){this.$prev.off("click").on("click",(function(){i.timestamp=i.timestamp.minus({day:1});i.displayHours()}));this.$next.off("click").on("click",(function(){i.timestamp=i.timestamp.plus({day:1});i.displayHours()}));this.$title.off("click").on("click",(function(){i.displayDays()}))}for(let s=0;s<24;s++){let n=new Array;n.push("hour");if(!this.inRange(this.timestamp.set({hour:s}),"yyyy-LL-dd'T'HH:00")){n.push("disabled")}let o=t("<a />").addClass(n).html((s<10?"0"+s:s)+":00").on("click",(function(){i.timestamp=i.timestamp.set({hour:s});i.displayMinutes()}));e.append(o)}this.$content.append(e)};i.prototype.displayMinutes=function(){let i=this;let e=t('<div class="minutes" />');this.setTitle(this.timestamp.toFormat("d LLLL yyyy"));this.$content.empty();this.$prev.off("click").on("click",(function(){i.timestamp=i.timestamp.minus({day:1});i.displayHours()}));this.$next.off("click").on("click",(function(){i.timestamp=i.timestamp.plus({day:1});i.displayHours()}));this.$title.off("click").on("click",(function(){i.displayHours()}));for(let s=0;s<60;s+=this.options.minutesStep){let n=new Array;n.push("minute");if(!this.inRange(this.timestamp.set({minute:s}),"yyyy-LL-dd'T'HH:mm")){n.push("disabled")}let o=t("<a />").addClass(n).html(this.timestamp.toFormat("HH")+":"+(s<10?"0"+s:s)).on("click",(function(){i.timestamp=i.timestamp.set({minute:s});i.setDate(i.timestamp)}));e.append(o)}this.$content.append(e)};i.prototype.setTitle=function(t,i){this.$title.css("pointer-events",i?"none":"").html(this.ucFirst(t))};i.prototype.appendToContent=function(){if(!this.options.inline){t("body").append(this.$template)}else{if(this.$element.is("input")){this.$template.insertAfter(this.$element.parent())}else{this.$element.html(this.$template)}}};i.prototype.setDate=function(t){let i;if(t!==null){this.timestamp=t;if(this.options.min!==null&&this.timestamp<this.DateTime.fromISO(this.options.min)){this.timestamp=this.DateTime.fromISO(this.options.min)}if(this.options.max!==null&&this.timestamp>this.DateTime.fromISO(this.options.max)){this.timestamp=this.DateTime.fromISO(this.options.max)}i=this.timestamp.toFormat(this.parsingFormat())}else{this.timestamp=this.now}this.selectedTimestamp=this.timestamp;if(this.options.timeOnly){this.displayHours()}else{this.displayDays()}if(this.$element.is("input")){this.$element.val(i)}this.$element.trigger({type:"gui.datepicker.change",date:t!==null?this.timestamp.toJSDate():null,iso:t!==null?this.timestamp.toISODate():null,formated:i}).trigger("change");if(this.options.autoclose){this.hide()}};i.prototype.clear=function(){this.setDate(null);if(this.options.autoclose){this.hide()}};i.prototype.updatePosition=function(){let i=this.$element.offset();i.top+=this.$element.outerHeight();t(".dp-menu",this.$template).css({top:i.top,left:i.left})};i.prototype.inRange=function(t,i){if(this.options.min==null&&this.options.max===null){return true}i=i||"yyyy-LL-dd";let e=this.DateTime.fromISO(t.toFormat(i));if(this.options.min!==null){if(e<this.DateTime.fromISO(this.options.min.toFormat(i))){return false}}if(this.options.max!==null){if(e>this.DateTime.fromISO(this.options.max.toFormat(i))){return false}}return true};i.prototype.isDisabledDate=function(t){if(this.options.disabledDates!==null){for(let i=0;i<this.options.disabledDates.length;i++){if(this.options.disabledDates[i]===t.toFormat("yyyy-LL-dd")){return true}}}return false};i.prototype.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)};i.prototype.parsingFormat=function(){if(this.options.timeOnly){return this.options.timeFormat}else{if(this.options.withTime){return this.options.dateFormat+" "+this.options.timeFormat}else{return this.options.dateFormat}}};i.prototype.setOption=function(t,i){if(i!==null&&(t=="min"||t=="max")){i=this.DateTime.fromISO(i)}this.options[t]=i};i.DEFAULTS={language:"en",inline:false,min:null,max:null,withTime:false,timeOnly:false,dateFormat:"yyyy-LL-dd",timeFormat:"HH:mm",trigger:"self",minutesStep:5,autoclose:true,displayToday:true,disabledDates:null,strings:{today:"Today",now:"Now",clear:"Clear"},template:'<div class="gui-control-datepicker">'+'<div class="dp-menu">'+'<div class="dp-heading">'+'<a class="dp-prev"><i class="fa-solid fa-backward-step"></i></a>'+'<a class="dp-title"></a>'+'<a class="dp-next"><i class="fa-solid fa-forward-step"></i></a>'+"</div>"+'<div class="dp-content"></div>'+'<div class="dp-footer">'+'<a class="dp-today"></a><a class="dp-clear"></a>'+"</div>"+"</div>"+"</div>"};t.fn.GUIControlDatePicker=function(e){t.each(this,(function(){let s=t(this);let n=s.data("gui.datepicker");let o=typeof e=="object"&&e;if(!n)s.data("gui.datepicker",new i(this,o))}))}}(jQuery);